{# Top fixes/issues list component #}
{# Variables: fixes (list of fix objects with: priority, title, description, affected_urls, impact) #}

<div class="bg-raap-card rounded-xl p-6 border border-raap-border">
    <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold text-gray-200">Top Issues to Fix</h3>
        <div class="flex space-x-2">
            <button class="filter-btn active" data-priority="all">All</button>
            <button class="filter-btn" data-priority="critical">Critical</button>
            <button class="filter-btn" data-priority="high">High</button>
            <button class="filter-btn" data-priority="medium">Medium</button>
        </div>
    </div>
    
    <div class="space-y-4" id="fixes-list">
        {% if fixes and fixes|length > 0 %}
            {% for fix in fixes %}
            <div class="fix-item p-4 bg-raap-dark/50 rounded-lg border border-raap-border hover:border-raap-primary/30 transition-colors" data-priority="{{ fix.priority|lower }}">
                <div class="flex items-start space-x-4">
                    <span class="priority-badge priority-{{ fix.priority|lower }} flex-shrink-0">
                        {{ fix.priority|capitalize }}
                    </span>
                    <div class="flex-1 min-w-0">
                        <h4 class="font-medium text-gray-200">{{ fix.title }}</h4>
                        <p class="text-sm text-gray-400 mt-1">{{ fix.description }}</p>
                        
                        {% if fix.affected_urls and fix.affected_urls|length > 0 %}
                        <details class="mt-3">
                            <summary class="text-sm text-raap-primary cursor-pointer hover:text-raap-secondary transition-colors">
                                Show evidence ({{ fix.affected_urls|length }} URL{% if fix.affected_urls|length != 1 %}s{% endif %})
                            </summary>
                            <ul class="mt-2 space-y-1 pl-4 border-l-2 border-raap-border">
                                {% for url in fix.affected_urls[:5] %}
                                <li class="text-xs text-gray-500 truncate">
                                    <a href="{{ url }}" target="_blank" rel="noopener noreferrer" class="hover:text-raap-primary transition-colors">
                                        {{ url }}
                                    </a>
                                </li>
                                {% endfor %}
                                {% if fix.affected_urls|length > 5 %}
                                <li class="text-xs text-gray-600 italic">
                                    ...and {{ fix.affected_urls|length - 5 }} more
                                </li>
                                {% endif %}
                            </ul>
                        </details>
                        {% endif %}
                    </div>
                    <div class="text-right flex-shrink-0">
                        <span class="text-xs text-gray-500 uppercase tracking-wide">Impact</span>
                        <div class="font-semibold text-raap-secondary">{{ fix.impact }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="text-center py-8 text-gray-500">
                <svg class="w-12 h-12 mx-auto mb-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p>No issues found. Great job!</p>
            </div>
        {% endif %}
    </div>
    
    <div id="no-fixes-message" class="hidden text-center py-8 text-gray-500">
        <p>No issues match the selected priority filter.</p>
    </div>
</div>
